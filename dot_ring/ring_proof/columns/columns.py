from __future__ import annotations
from dataclasses import dataclass
from typing import List, Tuple
import py_ecc.optimized_bls12_381 as bls
from dot_ring.ring_proof.helpers import Helpers as H
from dot_ring.ring_proof.pcs.load_powers import g1_points, g2_points
from dot_ring.ring_proof.polynomial.interpolation import poly_interpolate_fft
from dot_ring.ring_proof.pcs.kzg import KZG
# from dot-ring.ring_vrf.ring_proof.short_weierstrass.curve import ShortWeierstrassCurve as sw

from dot_ring.ring_proof.curve.bandersnatch import TwistedEdwardCurve as TE
from functools import lru_cache

from dot_ring.ring_proof.constants import (
    S_PRIME,
    OMEGA as OMEGA,
    Blinding_Base,
    PaddingPoint,
    SeedPoint,
    MAX_RING_SIZE, SIZE,
)

Scalar = int
G1Point = Tuple[bls.FQ, bls.FQ, bls.FQ]


@dataclass(slots=True)
class Column:
    name: str
    evals: List[int]
    coeffs: List[int] | None = None
    commitment: G1Point | None = None
    size: int = SIZE


    def interpolate(self, domain_omega: int = OMEGA, prime: int = S_PRIME) -> None:
        """Fill `self.coeffs` from `self.evals` using FFT interpolation."""
        if self.coeffs is None:
            self.evals+=[0]* (SIZE-len(self.evals))
            self.coeffs = poly_interpolate_fft(self.evals, domain_omega, prime)

    def commit(self, kzg: KZG | None = None) -> None:
        if self.coeffs is None:
            raise ValueError("call interpolate() first")
        if self.commitment is None:
            kzg = kzg or _get_default_kzg()
            self.commitment = kzg.commit(self.coeffs)

@lru_cache(maxsize=1)
def _get_default_kzg() -> KZG:

    # Build an SRS with proper Jacobian conversion via the helper.
    from dot_ring.ring_proof.pcs.kzg import SRS
    return KZG(SRS(g1_points, g2_points))


import  time

@dataclass(slots=True)
class PublicColumnBuilder:
    size: int = SIZE
    prime: int = S_PRIME
    omega: int = OMEGA

    def _pad_ring_with_padding_point(self, pk_ring: List[Tuple[int, int]], size: int = MAX_RING_SIZE) -> List[Tuple[int, int]]:
        """Pad *ring* in‑place with the special padding point until *size*."""
        # padding_sw = sw.from_twisted_edwards(PaddingPoint)
        padding_sw= PaddingPoint
        while len(pk_ring) < MAX_RING_SIZE:
            pk_ring.append(padding_sw)
        return pk_ring

    def _h_vector(self, blinding_base=Blinding_Base) -> List[Tuple[int, int]]:
        """Return `[2⁰·H, 2¹·H, …]` in short‑Weierstrass coords."""
        # sw_bb = sw.from_twisted_edwards(blinding_base)
        sw_bb= blinding_base
        s_t=time.time()
        # print("Blinding Base:",sw_bb)
        res= [TE.mul(pow(2,i,S_PRIME), sw_bb) for i in range(self.size)]
        e_t=time.time()
        return res #B_Neck


    def build(self, ring_pk: List[Tuple[int, int]]) -> tuple[Column, Column, Column]:
        """Return (Px, Py, s) columns fully committed."""
        if len(ring_pk)<MAX_RING_SIZE:
            ring_pk= self._pad_ring_with_padding_point(ring_pk)
        # 1. ensure ring size
        # h_vec = self._h_vector()
        h_vec=[(6150229251051246713677296363717454238956877613358614224171740096471278798312, 28442734166467795856797249030329035618871580593056783094884474814923353898473),
          (45814679702293870727815102382322792973312871502164900445864672286879719929432, 10366663060843840980443461644682509010070253730569921980532011475960063024720),
          (2294410531712626963515511376415486344864096436787198521892438634300079773618, 45666564743483398291416943638827203456632965427469970485691572684599423229115), (37781602926202079691192485945240718165362563267301061306318602868108499053019, 23249168975537931202603012898051222655856170608557373941830453761509361705456), (48892308395444907517643935758101461306077215930777489400152866006755873864571, 30440149211889700918365699960964616055855289660370355556369810786380814924480), (46710821676261173954448865936270698450589949160201191084600493816687873437089, 43712008156687655788569134346656742906891403883432923036907113676374102586740), (33959725772791636740726307435248874262183452318829320287829368841435916907428, 32354052685321206225714597606791493661748858534811367595014257717645002483752), (20730388405121238205586056240321141157041688861516059904445021289388152534968, 674484918737064324014917158516409868671510364133388239939257396058934255464), (16131362598942923370742648627493404284158046398356455674532304006392699963784, 41759051449636039640940435593943212438174603342641870174156918396979830436505), (31746504740235994508019184983056639484113543027265130538444973301468014574675, 40020661812774684076139962317628013115043125515842648412913638336815424480321), (10658330210247741704130702787632269475186125280005649475741514069841203448788, 51211381474299144263769069135814912006294003406761207076438553256538295596903), (26989183194975812980653758758148556666249424346979585560447166136015804274887, 7923042378685699684270772257473608797919241770366004858753557601395186893241), (46758996075230581319927526207320462313576663594102872818260662759156533030988, 37371854080171482430947161560713637722103700764036260827355446741680682234036), (44874626644563352699637540076877456455144713010634584762260243866588545765484, 42842156496943640371098049017669084660385349236625894444117457679793821442541), (8806838455184927646453615075702846391580224825905117782424074962183379656298, 27945304194937699485109991241774701361157019190115156700635684080365479287587), (29269297219212512657594381637709413479744755537104394121270504656275445601940, 14877828372697743222106278352333151062161845113732131810468481816097973895869), (36119725529088264166244575792191399880808545923807049745952161066186918513432, 3356938371532916992340782348445707582750090530195487048641685246149684602949), (47956441946952512609582858549225606136138434780344535960442549086939056864346, 11788531131703821868939578476236600121728787666626560125979554109641620571382), (29734627287614769165475421834769833627407536280713880527417009384449131335937, 22933354479875483386360275957381763134503770759478514930883475965221289701783), (28633297236503994300558520694329305262346497957530556328310863263188364255764, 14463309003168429193213155945298537967389316383287506303676067264584670207265), (43892957263758742824076138014666106063564740361863902039768060734699183844008, 43445809266335826884859249726025798571136893063222778068085778421826591572666), (40700431972617538560825825225897544425188527227058705893401022950798293535580, 17433618999532481791433440421299223180808333490554622532678879326163205439020), (1829735289256150024015524984663402633980184263148653328509623654356693632010, 29705539053276763006498859928557966784257635091372794433837610351252404048637), (16519555038211821891048428367531020945970002685319187161337391824539163494665, 42792603217478225249814946296909333586109458328301560948796437681225725564145), (29458507028459097710326609312165154384891607409011939726155349515263584973910, 30439909443480008512487428105120608006643664886637692090389245549325372445959), (28304886311290122075884580105196187336888523044537561486877966257830272604696, 12264658190120547025425833838110514254969572681172354754541292774285743400711), (23789862256149602052372861235345568280135627502057100729964123692171016373757, 30019542948952705941701399201839777301075089779524394630937077489393250240880), (2922052213591219428632693799905217485976229995963664495977077909421809230003, 19827213841167810175453980051966696053250869666488804997518739854239110223782), (10596741362841192023038680916070419650275819793953998204421084140209023106983, 1528672027793421672342522725644711534125532449297938273195875373406168037837), (15219813822669087131842004509364833923708689152484606416800384742450268610961, 36417948538030974764866593489505617693322037646104635842111620794883559789621), (3252914891406338037978801401375010612214820486185395882364688219113913269871, 2130787092367035235701742033734471894591232701148155680212160270550134193309), (7520090189053207183355864216262748182500352492145974373206933059356409251699, 38431220709059609216995581254319231004126317016479610911567967257507845383329), (42539326922111038410403152777027856318094995251532032069004733401308542443653, 28076541068096463421759332739555134429807388390711286025054098968027517491236), (21803698571810285500519649899541592069517626995371597779234917850875058299923, 11102957339239588974799779241686224597020822083572936180825282238797831901219), (17275494439603989156504258222361458121148233911455315005661154501842599278871, 40361784943924149045682202358788306148419731322942810178310948031434294550852), (21225643298626850769858740467733930392404793827484553548330621727632451086095, 21738084865369718463224006954034564072345397223792996331327611890275539498498), (24018545575654202917731022495740505294269036298751059833226829118819251329745, 39144754797567919632102765031145300468488339023318124611526887236947392788791), (33385993996868839117550199976351028416224483587901338452469191877231019549442, 31345970493855166377343023367212221789709258107728307575966256584773144136257), (11310694447547312128460079717169731670270507857560701729044289269210774949557, 7626931294890001328893010072014005937355876274277505414835286217814114319422), (18799712896408196535144960975051026836401421622233298193485070040343740152704, 8803194744617559355416855938346559338940958089517554654570085314778107280694), (13848229875770287715305090392896501151241993173286266067749454497720957640141, 6442804505944975765046669335220293556053214988784083811058901839412977533761), (20056730840310577373213288901299144833711217375562732576567572124771048176471, 38759895815513850322554657763737152214469269395042448010805672287683776034728), (543389101338800467986407041745504512845108624860149345265020235124774760096, 30570501700894356886357465446523542986353202137148757669158262010876000125531), (33899761640097023104741572449614885193907107327784005956736405663431047458513, 16361973609159696387493749885536345482338253014919350986374950015857537179647), (17040641779548008623197716286420803861410630356848477794247372546494686292504, 2883410000903933277120916093006922637162781178910895037345153483912803964135), (33303021869822708655134332577085455666329909088744593371525067815890222019738, 32463714243223035321306625068528492357138750641872642368426844834315903452398), (23060374269993896145642081186176404819764125112949280627321245259593770857933, 46716242298914006746039675051254962454663512272620134231516463188934134176839), (49698191802806359441205817314830268015572568919576035617366120327707924654807, 1279405484879452974555349969096987798231770400550308453650590065663474015571), (35718356650698617460736706917896210633915182950925185366981579666188989542583, 7618488849383902628124894953737181059463784982844492868485439949378308630300), (7701988903327248716579757749415789697559248961457558154666457421521205264151, 2753495646337966885246755702046090022197211284323236067267571154451847179369), (37278606325993644503229414191736934181958938338596506912948018674864466265937, 39782836613774037063754595222596822639838963467678837826666680253349081635459), (38078293013396221016642101918298110220695716125859078766520376914336220233945, 26502166328074690410572835819936327622522640771049436597057196556220863586074), (23339086643788763906810934984862866279810423517043171005780992357486228465103, 49699920170480361402755502249543146156115660174413018323428666777172762863861), (38543488144414011571071647045682609009489673676137681390133226896160675021089, 20137739018455549527293442508085234634168931166819561526095908775472635750977), (31252898341334420346016265019737625274720144325727566696134137548415441287021, 7215143971205706176002063809607948255638414001631308613700435108494980951582), (51734464069787106431048496054031201483495706502041864649721627484772019217272, 30342095935170059096625290751064810926671607866567284626926479907731412402006), (40500904341045244300971433953643353744593032685703993709499135750698527218398, 4823078754992642981161897537826153878117924763988924287209412312063279016672), (10055395301802389406848163715577138107601196331181824739260577636014864929938, 22339787765939089006733590023348469641873435663513782678283411661586673076833), (24212820649587794786945052213132501612074421911684031864832935209259182607680, 32243414713213691452648102966552483974596650036935118503567289119427981347324), (25583577899705201176215380483525754954348869969894469303282422211206045647316, 27221627606687798155434149837599266465152127253716319247630753333163586286918), (29195764229821907037145926162114240080575896697864093370624223084968605101547, 43881126380712825305464551044685541079273953239677148382709681153790832255882), (19893206053308349237837892280761921382560041178750588327732436416129758025784, 6638373224867007627519439073899652404635801474850554768632727265695804582006), (5371448867817717734535244503671703981020834895370392886424585591057934926530, 47864094065372762013342113196834825166233279705123866182323488218256789329023), (7073360799715780664706509384774196743839728250147449456883204898499664230159, 17058932592793807888911023203359124583101208999640222081083544187526760568668), (10802953986417484121434677394342147254895147777906631859791729097304406802795, 46169089165584240594301128237234710408388873473490329084353340478842789552005), (27246726279330881962692704237550189392708787596326449387010360673329902336931, 32871163470944158919551821783784119086156485557123262257201534293652150979131), (2200497623761330403565079250590964605876723604348908809550501732846446790279, 19457336826020947787938183467761402196271983482255164459673620956328480494038), (1900882287611640313471408642393022088273780369908384521447282795851901824030, 17637417602918751696175767223508514677264524237046183235904225465260404122441), (20383833841029029135672695938236094250551596623576113754946483333771882946961, 18543091098050738698035016927621077108475620158337356976592566163051488598371), (37197953552604477525016196562468470289499075930820093665289293466020079208941, 8146195605861039574415343150058994134278238302106217890158553443028817574130), (13380526046449491894272183280513383350965989737995735590992420063635027147895, 52417295150848872173620066994747422058856761988672290018406562886957719841875), (51912959057093812819176382380164457692228588804893241227084681963495070320962, 25964803975463112848489433005945576484343465399374941390642032588824858780137), (50038171757275485494689707413418706130280660874729992507106442635127240010745, 38562943933097885914521826968785199225791299001606390492800930968811648493024), (7922347152010970304007474406651341342631461882601135980473617362451138880461, 45429919026117806993699460135551335581848589775786170711475589209768193856127), (48203274326187906799576844392258609827827555378853862866121500804354723106990, 8894112497613783664720821774981439446057007141573799727338962239023891814844), (51029248841351211997647466116704643653614946420065773320917275517742681662315, 33527575442015890838666419392557192692852886773207393306941593706618211532994), (27311921309420340839039329151118904815311393357863128273367664404164814178935, 49513485813846536991880250595694194156626699815601688050245107224143182394350), (20493203289769804638609148203341801869726827387981851894556811164642298326464, 2553137786863798115193067611864961390875887891786789325243041518242077999062), (573372895297618047902578909307540508116435874295038533913092360674260317213, 21875784442106474381298545479235326321387468592946979921961991847823563527194), (37115629595012366413237257684301545908894917030125766684524887402993922499122, 6798882961669521074259320526498097410009225108945912286193064292388005811069), (19339351340771520012939532066987327693822235499449588462963788763203274167916, 14147737870451210092800576385403044106977050942370546950462415257522485855441), (43634483216978253109865049587075547006546380566635208809789277417425189385529, 9146389220523629660078013106770603510398191268980526481189913915134002824430), (17845142656937603390092161920388064780418293537614715090177345647508743292085, 10393801895072987292928649989074943704292856460374832677308143515656237051698), (30019729098904348124811917943299876296288610236925007699717215679608196154714, 4620148460919120507456818771483001283969221973854159788103699150922120137341), (24033383490567082947953362980124945397683742515154727875202867397012964525374, 32895752376668284957058971542364295144165489642708138790037842200805393566110), (1503920349582570376960976609481670751384405627833819305212700276679966294485, 35905331147410815367543643559507163817241807936373214694115254003488991945396), (14545766476207854652565481315159953253340685939455215485197524092172129924568, 37911011855995010308973690989727978261697194067851022342424845515896174830008), (8474559048761204310271314005867011642221829651553671528983712787230237577189, 36242782954997526388002581306856295601439888079141649525394334524261199544146), (41006156730423161933656549080383338541953495516654355553392369415837711616820, 31800888422537433751103763710585948985738142230661012526205494097238168113473), (37081223036118661123085135517930834196698271531424991993642307210433116424535, 43008327504757110947789059295303211761817203373447227275811620143186748685563), (43650533591739014072368030367251417094587657527201718878386605102541543166662, 50906649708611390118153555240916720856515663401454996147504027795495408919967), (46204990233605032158399483270778374408772215491801113191108794839202300801991, 9385343522051358817740423264194778053122088830501214839007081539799611773816), (46311849378669846819196703895043259914223466002906063279122489566844839743085, 31721719130227444016979792793913105293838291018594688048654685998447786880775), (5321770769061056790337209583928841747646097724472184266958364320238419907605, 2212738990213256508029960262514862353107699670672940203669358685910625662313), (7472666993810744700359319376351848545402053341415282691495631674897124445638, 46803815544979811193623472532515558256968417283099632985863289731843489855298), (27339892361141095076757917889952001857497531006806014763288167074874256893947, 5325071908996582051742690904547301567001928602290892164571346535818850868870), (47136492147652941023165508337161824961560096576334960897934216744387917543055, 29241324138688301168370431543815887032949571700785878180135693299092105691595), (47135632411304847123614882477830273830750423924173700586656178655114517699086, 48183733616665304157630803180272939315883020249125499547466498813734071344036), (12305545563695375964603362056643542787423584905376138224311490390902943027059, 16345005371486679665256627608536946829831746964708811815157119872291015546996), (12067089633230201488777462779076693236456296890045945608312543561727272430525, 44869777376922747077031421503952305900444040293851978848363130878477960218617), (51760113656537860885269715833349908631840151277458051164160554701805462528570, 28121347228161198845652659963501681249513830168918134611149512314454635337585), (38011830652239924278437676620094549499345784851692420427943736423512192922165, 36861243768181445484735335228542502070782404605773177433847453100850089986853), (40413491697032497847501867518250828391615391250734288496128449699051812738654, 33671400550079486523990584727805443161559284744912120774334670094029641596961), (11101612934882409310956247267641887840109391756137081614477201449296956866624, 37787361950555805357819709691207276163788361437993231285426705777139050398128), (25048278573072926443676569915135441931599072180136504452823396526315422449723, 27393125470503556590371373148916527398963171468747447595774493021392021782357), (48282293980314225935995980631893493802621894863792879765603568989639981283526, 47672842012063821365301381202423784898981246752306163850440889939787074270692), (43306188464324572569892152685126050208629169911873351343341410949885807402280, 29531739419304310347349719667111978902654350919005926550015410852631476802833), (10327881054200440583752484543166914156508740737054117532958441239838089421544, 46357733676158475249454272218258344576994192747009826514978374655193425056703), (44794091184182092950885742579848914680079102514603698558704135001347397283529, 44878017415247356854352223725493618214571761012708769845444553073525210128023), (26656184309644764519911420403584869950261279057502908896840260259705060033492, 31342123539109177242613093934404354373489516662532677395458206564281075045519), (41641090088211596270590810091128475954006349592690171350104560191479593909607, 34597775524107945008105029116831288778352058520152305426652965034879305977648), (8597353254294096704881498212010426825373001626258274453369418123706810569279, 33174837280406714271871054680666365568394399142968096656450686772015674207864), (12201406835509855182578748146313861561796732942177576356310790085688353121325, 26269163677547222105357445025262370538259947139011092290904139501729493650615), (15900236317183547094519777126287999835019280329291454161847570890277954533121, 16509449318299099873118680661994784504702641676085918594429161841909239689315), (12909900500921486890097420362150237509220706309950401554755523068463313067636, 48098839130302077134680138857577749428500385957363529362302761072966913358700), (48991775332828423054687995026310888669771538663325442608961720895274300441184, 44858300042743507039518379582257814823370548109285009083811707416417191261696), (41480405647331819662768406099594022385297186019509225019009593298776339126043, 44839197485956344014658170363398068400472242888564174721844624266431132165927), (30750899133194482970116331331258821801439693632061148340153313895189289634192, 35224153666089855847599181854265220578742575816692947822411329498067593703748), (31272279186264841041046811823842400207137904472191873956821565242430618223256, 21067802708452854743449194991490172658131509974698116180576673019258433863318), (15983846702214840191329614462205432634397930344982357305471559298808357232460, 38238153743661700798052716399459155290938117676316626555230133825555753950840), (32676107344515129542055389651489135244453036600595275809233250868955625974987, 24512827460447995715704560629168669646001596765007529669457185856811717079688), (956081933427937956175585954447814483596778129328138353582048067661225586199, 39265365352317739614384451149176817374496150755440131961189020362912767011766), (42901984593832544401445056434006545547263838137182376457720122120485777563020, 29306013376228479063273695715145131192034904532673200625017402537239522229434), (25232100469321198697216934908367643007753427431282607649915103185579888442267, 4594932774602146871992949604937795155043045651470118683907907828535013053501), (32656196505002041343887090400422459463064075208224808621934341672967324756618, 51479724205860392517912792008736396241035047225466509311724385343813595412903), (13151799765421279292454657548138270148250687959923003902379708296305646016841, 19501133679898304900017347563305608529364170124681075170522115012348329570830), (30088540703836083629767218607949408735551185454739268710310165954346767143452, 10495891470299162020324774486043365686174405207775674677875550148838220993150), (35541767796347844722820374679746872886210730312760909649003676418432378843085, 51819843439711516485244108659892523674586818671772690359375283870744219100465), (13362050514546775637681980586398882209986731940219581788489478001358885093856, 8797311382743385001558900756308956621028158215966512655200032236090180490818), (18574479202872833761124352820798333067008239560233727042416608875130825971701, 35052483683671184443747444273857803238126739487681494915060629095823981586091), (20787978144831188819703034216046031907200153745188379806235872698093217821363, 7703680691229620165551943513325152793630858068270958287174785125337828892716), (43437291832417168958786079804534729738763181235566480677892904876192524917216, 30911578673450177582902853865814238271429398361250264536880441678265104094329), (551634174434622705647040519208511882540165156260749673132461746584212629166, 15606542520758754456455570731514864509838257961740509358375084281340655482818), (2806593466939723872191373123476325512803308674209195956090914391016988737314, 51053526238852765304753858663271276801313878430783577290655690317975850046639), (34932494705791208552366958213649291305953315010002394304464984334144503950770, 21593671682613139693343135028459805700067328813887482611459815377315961843189), (17453707719380907756750747321688945906854968333997977281734329533923125400081, 48660903290355777459167306851945619775786637165788378651556436282710409198216), (47076411656517200483559757734764655319475949979650718257117635882036260141646, 10428459357051563215188603494176062285355342092056656651438069269944661611583), (18365744872594248363162915164854043420037423433712772012247182537076089724121, 33664374099011795645710751544990097354578213308460295666089243882030961801801), (23578583706807514368764790721350287909402324132917974758776930945226329684936, 19586218461055307195999382355620585370357258475895992416597845530473851464368), (50897943840399781330461838592722019349951315236315610159935251120393235655187, 5517854567172642959981450150653642805123562583236381922466781337867803102009), (48862764368818460902536930356774297164494788393590806686929655850848327283581, 198920641283129463584503567478726358056048238563096954264958541625047707789), (15540395343161287405665320017600873419710329386263347821910536685904520700398, 46882608792008415101296727737071489519255201362249453092956846051061762410729), (47563406848037389745449537986684130761541169071644912920008694467759008345715, 22596850619469802066144466578526594024669364805802153335586766670158439378612), (37339183657815850471328632949405291178902470397984064479965193498910772956006, 282295273353481149039815842313807288310640368313791687136858495934228907118), (1580462839202246945147135366485726103765842092623141224104138208164820729444, 4343277570643796988449623134101664709644782798352603504817546910354511027977), (11170768031896332773302564009145423701734996730640617300033848635661832948697, 40043969037450032039274417996518643065438232089232743271917523724435963121673), (26856907783419251724429792286211414100435315499356823598953357780532810818173, 38829885760781736371379595012159764606416026810013768142386879573504281188313), (19878704852962068638158377352450289532968699582639729412672053994379113942075, 38238022917503894099526399270029084575609975886854650220856125772854641636988), (36261966811657051320737204758070330153337166127616984932773065152578342594413, 35878977666583099594542481257208283233658801516422215544871503620133376752566), (43229855614377553320661787898335022753112790158049464397696803505367128751559, 407945287056026499253439560000191605290248179842278749559254632655217380007), (18899009600540989776625164013445963966902435197939575395415771573460998290465, 12433339169259449713933837842229651186466259204686439743293879689778019763986), (29586285825540862458778263021756759736551758399510962341625303786381100615588, 12730054546154870053608332867374653753972815520472795646936638369239193289926), (40495136798146280653762565035002205822714440200126293174792096877349092898475, 4968212436446081629558682505143079664054745392028825801370526824362277402890), (16770778844514691265528477081178208543962484071014814557497952515593458386151, 47675098879856756645630458954335274282874993701500914616486460934987516802187), (16393423926799359357808820903075058689281450066551661427402650381506508567659, 35262023327123688211532647109023518204836363012472273535847374858433589478107), (35777791131104909183995831725450754722145349750989450609382921726035353786452, 44033168132642711511427362900898261688382820159578048628897762724002077778377), (47602292821956057994112714094788797434417985907394962291842700112591227290784, 43682781577152499537621040276909388992249692893413843950672268787317991850376), (2637949168884732682926893487349677527221911903036942132630778352641310727080, 43254630424124981023292323022414165734988391163933164847072310574552640041973), (13189567284441049411149292189188290527714706334048882244628069593820319894950, 50996087934274233095667970520295262036423366727401511499087751091508426939639), (12452758637809614154375030410109208650119338714931899671399926107340162646095, 25510762495099069442990771444067074360287817858848828696967501902065212014107), (44745844624422648587478397768415942515599769657505744595917379502361336218892, 25104496832006876801315108989603766225354076864838032334821497347755969575961), (21325449356256056081037738688680071892539448925748969091366708855706368204692, 38214852009607279107959259048407596686770558255405647092252374856239095136664), (42520517035512549507477339774011070340539549639618746812620233812473133101845, 48560210321879526144272910299001381989351369388635280898003243515564578423916), (36645806019910990230452523057215193437887829575108510801839966286549518299129, 34433165563442456227373710766299136928185614744909298420066916061372835696623), (29373623611492378944363701779896978522559647349484656328310146258323291127267, 27188108474718048081459891868823036806406477439074253267637731031152069179835), (12130239721996322624536103315037364495639580092557065767512515182831040545016, 45493137345189350269741369703556337463711262454589898961968917037587991775025), (38261506319147315213211431345381635729502127372874719767516606705864994559415, 37625661942666348333748022520122045277636070877120278124649217415927457432461), (44649178164485745773310285264083358970969995999515794475401311841189880861726, 33188512923139715994780317623743132949667970992480421461554531677248323082345), (27613166411502911965921840253754324891344599056022259234521210235106570273973, 48606882746424112969952502226262175779362444670092825569358699497983810468581), (41553536104627716500408567379578043924109162678180570694277610758176259417589, 39794240611840882903731679023352262326566254300372562671407218830959803584392), (28992161345724821410116466263594079628780720488174324185291881496955758513213, 43967672372116360403349984370316047616526251880470571096360979194482390554350), (43118143878282629532181263426009820929278369142797581456867837271656995626805, 11256953897511995204267454005683618090185047634983654593322160763622453774041), (32201282329614176029051640195043478577534827656755296368598883443562399028928, 27142846313232474144722116724625872691626902317778132386523130531056301627235), (20586094000461962548881608777027808918867234207218450449205693618999277021070, 31366806236550025866299066848771298520689538593953017613511668955723037875322), (51797770355865457174328203627968396870417770368711354837812955815522043223942, 22604903231750974927369507178175122143915723926451355430918271640131834525020), (49885147306147628033450104752630049958546641943705180806782519946994440701783, 32188718880295064262803835619193670817807304955393320723169181571842363690657), (39822526604597560658025033739669164818436204868104422953232375250884329297283, 51787228950279955800325103710950891543071142224054900300921880558015732874653), (22805260156517590146097387166512422753836424389975120407385973921633105187541, 2582474107724752600772646554799214493255450816506611536706773755525400389989), (47178178412450274706232791648429439401309421957407390227363510564133970874486, 52363439908490003543271810186060192807197084234930474408922189290575012475994), (4088007764776378710212038156704497077906930373538904436140110534492297655948, 50479214750702105438101426744773584177606845491336668993432145009472730988249), (17636674609369589892162330278879817950220779628456692925809273839857015536785, 36040732138061038990789657020954136395731295180647264091377429244446035492015), (8207419588679676650473690342594217167360076754680629207671937356916081509524, 11039316039082445781580677810298674603992226495710586819268193926086054340423), (10578337133230619226096380322520667046998639562500874194166563851058734871486, 47317132682297254914449508822387584970838303112574987690915879413181666231562), (13148577941593124761707188557993279913281542134162798167918744549599189222344, 31742868610511272298076834739999056051507023410783736123579149001750352475452), (1509693785690678497399536528686617177940434434000797764196109961792783464919, 693432721443647797901391291031440624744448161651634226420088202859513065161), (34865431669596079979790365570596434819310745709717069000447527142748890326771, 41407654642670896521666313737574471046624042176268491526339009615171187170810), (22662272326514617511146499102922298615569923233902551844317662988090766127769, 47046609541276402857774301808495238169186579235400378709019778547967841299803), (52225506507528832239526528697508132235524166982298583093222573265314823165546, 41729671646123184733014511428955428884823534227839926110455472591880345518257), (52226874135455184635039581602061202521485568118686035542165425883014531914009, 9090234379575640995431620661188150751869360998617015206560285313258771691124), (43534526985488093112891449357318073855466174924142991769633639292318651718508, 9375042614863573306924313015939888589225935965956751575155268336684914057742), (47885489832191608465757391205022082988606570533833136368644370985658993780861, 30618406420289510771478323740846235702378775761852968478966701055891841137021), (36539747886868870022547882514263570507219444205188157697119179290635370832486, 1541220453273480710635670232345104494057954151916251825926320965130417795292), (8103971695426296734829205733706422786242174945930083007302673681996216389100, 18780793347830746802199658814064758763279095777650407174395039757185963506661), (51192024854659905853370522749448508386981626405735730216103536542190625782034, 4754118971498245163130346177897353052506680741486641336660127617485795538208), (34270259883619532288718381906602317198835875622905190946616290315450484946601, 22742139315487236072659056612750607866250802513604909205916216654939973274865), (2509956601224468698818490537307571565759359759998165438143103879959859774333, 23145502291747159601056279970506107137958267018320483409695023632829051653656), (9621009472607533810864981754758525068473437816619567807287134298720330238628, 20313772189562316679843075082142001527976281296024199484225992006281561371221), (17161750145720739527973572417320723266004489976253330962671149280745103985781, 25435251986557138807702989120755931884500438648293774151791801727734089210325), (1034046624615978508825336064356365041527247561725262177976077127426216023076, 41678120873765929523510088102332730266023109612033101250685051483707954506261), (37441298527979686354538513517209597301529521156825216323509429810759057042025, 26227554883860178269051679261099236844680750049710881203962049144180983004895), (23100676652656583701921532404339124366926418899297369492527819143536933390667, 29248759711904586543120439465492312309476687707575861444598903034657090880297), (27667362267956113400539778981181625952166140771850294750281263873292716772520, 30065709626209683581516052928200783002115487189258670441379291759696246890554), (1730012072506199865808011812864777873025497353364340878272206302110637861742, 6452459301849638284449484388600923133017945442610833864554357676337123063059), (6987142702516449797550730713918590494513216827347128132465361024816152868594, 6949187637272985471951912462589237277490404238729669025920387574207598302962), (37424868723273497806015580979472300804286399551887998039601299565534352067551, 23452981732485905241621993556848119414957309122766411172572591507743835530734), (13645071886729443767846109161632222525766270853219907253119559347341481883256, 49822648195473271759864876932597697234153600370805512606586187569342132605553), (31824906445117667123405325130209065884034550048555125352762287575933792867956, 50467847301152026589509718875272094560704615782399231331046179435108517501734), (29838272852276932984233456018159674723002286641194831584074155918082287486121, 39381490155839502874408839399823513216454459253407023359764646190362181121871), (12149921469297688516231546458689801857415336542543945602124334550244141807560, 23871831277920575581242590296120600859927334741636466901364922232106317294274), (10477475954054620152227264519250965424084326606602290314390720030572475754174, 39397421997778148033753679302213836673382408921805844350558612145563295373580), (40917764845639872185976297511578221065623432766141564371500805912915161864149, 42529263994827685089307533779858447955947951159660672397028024875509196869159), (44978742877306827217275687943919321246038488770019601657606287301198408447964, 38939676825049416369825992357154709420404149338139548855185669501936418313265), (51072867167961355804059247652498143096033209733292409585430702478473631348641, 12928868576137929228251776954470943402443184192092183930137289289571299189568), (13652622782677452035153795954428286555643334620496936753128267446366630047102, 48433999594282153834482313709452197450210967132533738236910861112332396488342), (13268371280514530178724711345003354336341053735958468313667498393369709066041, 36843524273008882843662978284517108832820955728020287646342954840528917783664), (28716811674462102892771045501661786870492265339075727238022455001277712367694, 27523476503030783279419359981230656363809516754859201170014366473242083148085), (40082516957376434932496564858567939037274889816285959359759139804871658057612, 50687159378159949702243168489853325059789577023164239569269916292904719362936), (50530076105191133235656801775634650112549680698258309489956093548771798777384, 1255132129993913969980540182447425614142277120690416165981818444348173585314), (6243971043290184862921048871424885327502024054990536466794761236585313557090, 15829784195894748035119163454274745570163036879027045509854754870336150834164), (29530736080638665784673062268732880635323157727438884150477255931529091162764, 18772686493863209644330410773863749138091929042732047182309971052202542123042), (12140097860444075389998213930676915903571307456491056724124949469521651242101, 45946957952452703547340555247924618743792586786284448278910832167819501059569), (19949159654634537932514024708214660343772345875681021168628403191979839363946, 5775039020996609078510411187513544118242939348795558254437011523567550542437), (19855898831945035927676594977595089133003179820321666518165303345962301250883, 23446067513928096424018454649123556780295285913719380970533045983070388258119), (8031054363383169048354014581849015666804582571715397249939735020466475911410, 47260449587588772010510840161443436136314872023234056195210151119940855177914), (48786218385609600591528157851874802911591348728487689189352450470339615643615, 47325974532091177739144048509151952970158411270996039628028831926064426509524), (1414719632440624649206248011529605161042072365266979569541170542852744324999, 1752526060920454352227715525276229181373213136882212910198844685114642164817), (39714617752510599067196471754239988999860795692696243026650787677640315133389, 30509423034888459157666700151897016478146153950125009326153417338856643920373), (1300949251479927693755089447025592117621493756050637249510461584813960566067, 40456991707603177701795470587351936446838806073179282320858652392042934573340), (47164462400659569622114773407807378049705343331812917190546756367693814455852, 49539753681460324820903285650713974716078285132036427952735379556984087582921), (3480442779117845170160842792236947099341798085328248620958060495447619523716, 21443879199716750044866209989830058613314526817659367659935572048999857530841), (2673763073750222700491735205567287499760937998792374402343864103174142574295, 8035885544958053382875029124120807341387436936901449667169648837921633542490), (7138684992386411806800746742742110845674888472829310176368429481861698746999, 36551790963213895561032933985679390999544863850904862137878305114067552067706), (42393602503653045549308603142459493596795418107415372323074084123447643261018, 17961073377515655301365734907211394248444702018095239634133970679786967733082), (46719531350738172623708418273985693290274212864793251591423528768206504816421, 9964558612845070382765653641734797566157808476217871715634543101983128357931), (26840122014131376685123696715874200155634476692446017496280261714416910675698, 50067150711959241584060570833010349782908807639820729516963576647513090311518), (49497080158720342355298483260507025047485985330388634009560683701214409895492, 51899343214636832074535830264407623299556368671009406215417297887270671869326), (40761948410239012906424356518393728741879398298688524741935392687520099794066, 20465392399280456751973113391149353344793192784327818533859020855454516641779), (5745738518037962207573120465875081331442559571853421695649814706888319754739, 46453532484135527074793330756930509815988968623816531800239308119275400684805), (43616121611630366650220012023782065868185928035713879344538576576472912804761, 34764700515985972766218946000862400162210039018418052302091401107126649468959), (37471335903230831491842251269091159426682566673421750245335367142646353611352, 9771620000383064982324100560527703962817576417454662164942065280694809127336), (28015748650946293758882263423557035343689966232639815671890938032732269739483, 49585422337140757800964646258369976479718469598126202611640574595233898904043), (2181535661216170260993241120488813716108226191417156686945237322656711890511, 20067688488033246973839817574218265743757007976662633098060000961408342815322), (3883720999370818257500598680097563135380353459631384659904321567858174836482, 32009939314326575910431792827754683145262935206172330556137541084141010754846), (44709995120587785644379692654615658030667685872869567408590878534128413268218, 7689619629332712340989625684958006953641249478840863504893932129403525922526), (45353229266404481946003092689148983635123264312388143444765506897249342037571, 3420240259646002325769973582280526409148200854040231151117293080756378590375), (31258107529014463022910203595856354504888341581335200511023298622307833662857, 23667268527507515694344480221008456010570658901804247352037453755882671880271), (51228025645237797476739893785221530628682209446041144443111058121001543687943, 49256881685401065793648168295919493127593254960801233030583684407667234780607), (38148231296047916781791330357132269642586713472132507760897476969857109365134, 10867414097610190798021258094848047529509356375514117799304453303933345081331), (9797035235460900421829336184764510168998579919886840221094315149475790471137, 34122006681799173047903903585004644539739364435479964621682003498403228223362), (32592780117307417917096398246712988520175415939658971703975862196016736780929, 43684337648095622504305389701607046708940085854875885161756386948159689215874), (29235964893200802319492031401033765936305738656351774286506147762739440602614, 9413393654087890171603378253943184027711480964459803754207912851151817638866), (16881699788880679011227209678493398116320911340875886518398579521448538459705, 22616584773542098445780088514875913347491986525979464825113689571530420634083), (49601201589835441909995278885338331101895521028097202664424940043136661361868, 31176655915244630484577122697337584112939403395532198225684134660665658131952), (923178970117596303260097061813605356433239192023462917900813699396548555171, 2430863175660824080514805662668306360877417819425242029457050739619503730850), (17332518913991522899266122336441454437810760599720354962215638044545651411573, 12238941613942481371435755592263669292483961321188157021143733652679743121089), (50430907269417331144484650811290940118907418329655700161464732781052041609195, 23334413799924608882789492924604934666581789664930131063289880095476566780192), (14462314223358272339023261149111593843504042440995744575103026823842974856012, 45076883452748077360772942000247219264343639237941167753991208836292121964354), (19611443490469977048305538545868317906450660061135469767625450331960893535951, 11743861373167454011615454077371380595327462397976332762544070257828620066917), (47535180048337064453540832389667127753217349273284493380381163092992154587718, 49880834122231829123824336101188015047518290748568391817345701960830271331520), (8676559621810774202724512940476502801399752540219643098083405656993979779518, 23746448434905870520249694004430245369402297285246199093386403821724406009840), (41818816818117271196990053064173652626817035294769014709008838189211842190628, 4557320306429607457554102890758677015607989736208766552649695287025961539849), (47376154159298052417426931145002163292647696360124281124416921645581292468053, 5450851522352165941969293896336072705269285811874215821849541541381914303825), (4899495226861564203049759254801860018712756116055425446563595127791538158825, 50425440911681271380964838105534474717823098530230298406387141804628287538345), (5318642191981079466099132290547857177263881437675332188910551047122730172333, 20128759536896966852185458867652062413017609013675641243771945825202600891554), (9526660458232783641771381546269660878550302225369880102847877168105320933022, 36457909156112283346670360223824454327690288119982588688974204581941474594385), (19178943202861651420230489508312500114514672062763478960234930500588388784620, 44503872313967186586741737918499744271578270941819330401672074654323474755433), (38394666007960199265911596324464409734900468691702125107273339893931740119488, 832793070110478573008654211160806122753061556833288842056991440567009415983), (48083973462246293544146319842449582007838060536256242580079697826389079000056, 39841124161656327323887685847870021486830264640789802735026320456601734770198), (36030124439854216499498419061365718017444891800738125773018084273473200483637, 8499180157608094595797339619820839717850728815476899176204437572658748175517), (43257261203909494045538123085990346276387029798739064996117624304751260101687, 22333543028625096579248765896516281522236653225872862948318884958351181010055), (52039358364027682506715291857511059500443593773509766504993515914814208240347, 22287208726459625884977289184889117941271033586899018545839490129266710652820), (14988384082805548808039414387184664637985735308320407935669563611296304644651, 34305166051852001119387348541055177278768725653010942852965189248032527548139), (9873121390055765867027828784182845351647066967936582421382196127263668316927, 9763252532139867737828270823494645278436735400344735016522737770512878414946), (29289297586507087669894816249193359144110324896651410332354068271660316527468, 5713280156984024628636490382062840721533064264350439580052093068804213366428), (46912281793883941093835977434777671805989032660892112089138416839688657133618, 29936776776984317264983448275861615105371670589391844202808368066171989548269), (21529335550420085406333399275369833818996718282020099969671873397035102670413, 51271313229588430767426971404908329575723717858160493606001428614180457783605), (41823025398416046713826136437398868523058227079367256973049862809572172581673, 33528743066465384049047888962120540763217797205441090839763759949280790749130), (5798648999482079122445681581942317221053682170032028616554362251814183168281, 17552675477192536393606980539590414734671262625727839636581314951657146084823), (38869298754428500131415260100157004828932823432901470052539706757439380696931, 12532883833959902434628972529208806062032673883603405916184002447036050663174), (8486564839021856112714901229192675851313243442067503051608604216083490253314, 42358563222531283521717909391151534003831692727308985492395234949477082000197), (2445844573675035706312134085441476040247781194630977778734060267127100787841, 4898344945518613535449841162403892777778538246337911761863362349074704559771), (24445778208130079447661176103569341286114647327604758192924403816422539769297, 16567415346259353693681889104660308644309317841562049021858922229311160808276), (3963498795644769152736216971155362530994354163899794998010716114432815553467, 27259474931041734099024641103622534394822511078788488665102610833581505325017), (32913546143609358169191076425986005391477125696028048504797443930409599097878, 32667624806042879339200612162046675007549952073607598904110537679102633438209), (3005960504419706591549294851528691969637974354631679261159807617441976917136, 24663260378517122981383921512190584488562316068229218382554735304856431750856), (49533757065658911457165367097433890516893712396471892178559942056268218547265, 4124854995759576443071361808282564092993704755047003909556422265553501455756), (36873987844323152048696042612884834181454543157828437151430236984010318754717, 20613770749256889680540768815443084025316644417874458360550704104371775369267), (25716854258378865515712600117674753562147746943218046592269301979484206057096, 29200302959288639277796119770915014851075349179474194342047225765336579052708), (42911560815992809542187647398406526614655751338089810210811171485846767630340, 52243648168734422103104146063960238055209337495084239762818300335456103145627), (39081309997211710422590160365169998920843542197224487979752440434567242066218, 51792352345666095746973385040061186858694568629669676388955801353318366278054), (13417079138708551594883504647406003445317431853550618087243646523994252546329, 45825395667480572846675273207390385054524422171210329124535321637160295305509), (44412345321212871026454642671321767602491674216628155880799407611492930452431, 26752578203291804925203752349164087269060794605061222095076808133517757654583), (8975159844443205034284920174424221532518001869696294929711021579272114532153, 29780107729477494243160427509396943389176997188695048961989043256367644657787), (34435684342158284475283213374766015373786908259912434564240988300871866286006, 18862244570687843434474189442824794857514997617106896539383047412580172558931), (45332211537330250839801544401039681457134006746652527983039176821239728413361, 5504916668630633545914202065187439541677305183349031670953733015802397155424), (39391402705953349822036216553766768041698162534362956649814360085654540331654, 44579435648552401981465855935759465948754961403432163406421043046109509243100), (2391405785649090229285987915013369169470856471839783478446132389509588047800, 52164969608997360040867076113068647667231816788492547214163428720207453588911), (42491417368481378407203976749254355434245085737001380508577982803990262963431, 40456506669311874699041414550758115549608516246550995889572446474807389036739), (16878883369464088141232906520453889040210448602693072948258450421857308980033, 19412720200729738074573802570725056274448999858527815449415511296267960527993), (41855369849464903542322597101957727705462903339593763502220739959473838065036, 20547491801250082134100934078325171699840717966280362560722561591436507995978), (5256908769127062258064266008466007649854824448235795128522261147267806416562, 19474966794780490100117472442798723247358965612398901225376470555614523193131), (14234812243189163545860653956454191088659287899159410741320721115671440014946, 18062436552144427214037867564684284595995515416997731235679271843879405032993), (6665546155875621687655864082715914393470863005894065944836359319331016264337, 30679151114304893996856722823760577072034540137281217907572374316239324334072), (51169531245721073103966725961050917921313698693429129380801859537960664695334, 45041480176176257532586629257481566947449308306772303319565838885304016201031), (22557490567113484990786659366446560599951460869862618596071718559686227152545, 25013510614627611847929851970546489001526694635795500928997008083926517343039), (37510024698366909791512572258662791608773264998428749509756145309164918254246, 21816126229762324577869002545473647279621035131983490547659430927899199961787), (36159167776655876756618165273086060472969153982683268707740443513392794252395, 48782511182070837728821542166456457723300989616872101688375293466461664440323), (31677063669949123230542026557749692409865322643454471292506085091341656619469, 51743120449752716018075109519026168810939393147074598510632814633678425474498), (35679193974304218463556849193542880088870365245308732013809685147347466482739, 25286645616175358565804704410336572711023239849470482873907383038326186590724), (45470292783397293725403982268588098476918701718010510479468101042532804238887, 40122787787845836682148256408101594080044684224961362923609668325020322814354), (48968120966055636967998182663080061038110421029639661059744342697447582334433, 46134822938929659553017742208270840228900294668287884029295574086662165558580), (45263318566953546040723728380108680130789423328659111176783413197549227269398, 2323112496579419287693219856642983529553390624335365499980400271518404120794), (13098304292161283823517409049321515177067452533680203062241955543073211954008, 36511858780525541056530188202551440465132365571283170366455891285904147630901), (22545372880525631273553955944541447929730022131252123076818079111948658779661, 19132146490073236509000793216956729295315618267435059226778254139457869050107), (9759551573403632334058285131231452290926273215517125406013173421676460075360, 32551930992732560443186307222150474011043258363698242304115673211092721046016), (25535510109832372506110142998916046365804761617844286714625428907459087390525, 12301505033201655569801115908427799123221698587660999993270810129146942296197), (28912655025359194625502991405143614009045997110242668002500130684238889690659, 21672213739387828477186990724820468116468148852032484541567729810212944922452), (52162950387534396640435186313107935802328877170041713229303327895690887640057, 51974880467521381594385227073986293413021304593079717269906121318685809516699), (729162924492286293897058400000016270677291514278575782095778073676396246743, 36152653275066299645209814566844347965278710907885207751438180530717971575323), (39680176850558107181282626804569198042507255766032169307559628565830415464014, 16624607354238150051267330294295688203249232547368943802767531946884541926622), (45885028531524263758595975254624559773946162633767272782892201954439838399843, 9310730833093208429090527099226157705061502872155879778661534589832712701290), (43082410588921689320652450902903550042743570423367866145146890562567649179364, 22085566014831019631569758960865551569620159650890464334501062104239058170692), (20630229086238703620240010603250704940946722543964456109302697869579983245023, 23403871199352963131788737788590599749872244418846419940373599408614731116190), (1275454645378477241225856461631859347439683338213159712593221366022393003050, 23940677024391352595442526016965987526838799598085418119023847315515341818992), (174755997067861382565474100145774500727476852620619310974734391490370190454, 5345683640762590147670963376091899517065256706256925831019720051833991800921), (6714316361371682363512711108635182659044873544217042807172855187055287355357, 43216121105963286245068319515102386769098183977059974577870346074092503893375), (49287961735178532142670673176491029062120400308630117877154090040350032039820, 39387218379614543254606855154096293123707161932650120165637243699450762172257), (10760536170420356429585465620953119207333996655290035965079689736784007372420, 29915395160133936825366894138279821513357629660886047440469855723732201363586), (38260304077634719845992972380620804413918676665180958246080961043241646924069, 22523609674437102276485994390156968398917591917857855197889608126949341524545), (33623154513446903405765765842879358475866161202662480674580002096918978170625, 15048654796799878802626753896148597894818959598390857595478391315489304546229), (50685536086398151946343801587795673304118692810362326974765709894514796627753, 36790357932918822582808572471138465677889652328434737113330303557207770999618), (22381660927940252701141726691915942176112498825455028466350777336045885024192, 4895595177197822199261066097335571811610253811884396552301820006760927391137), (35718886019882818117127774003698693490327673753017445070814831757173214402897, 16424540735016456636602194680010266762916599227438686816969427126326058222549), (45001203760762459652464502164712502046801975496260650965909746298332550439501, 11735500046128803092957382926476187305991082257962357309226174352086056391760), (52245568278112476902284471779428184018181482351928884697240817096152731777607, 27359172378882675474463685262913525086836224491407937482806757479225612119697), (256501360496778141610332724211071337479553415010867786371205839181833497021, 32955553660817568420570815495010846483287617458764265874954645299520121558089), (1962273863224352856228117785015480157777199816825517623234100069107300126624, 48815662628551923257563635879222776307685683639123908067470937032496264118348), (41062116878603929979067843098541783009229180414728873557663891461585447486209, 50948877574667132774124158698904134736085720277286574162607875886181610297369), (583560613579289509837540598534143815278237178576482952531952107733357529194, 3154975011577492793178315031258150346628242711996607164885653231753169158560), (17330561320852301974993264578239774340263434740109115933027236429682660260714, 28362332515676794238205044713197689978582658971715240256589629621486916584036), (11783163081112992159026907238763105411935370447363282999465271590690527544536, 17589633841001211233241858577848242926292655847232234113117654776244672277278), (48279677634544620023514883631536542242146196743402989799328928967249378791317, 11177378887979543253773524298143835956016263280322211517149728594114918739591), (18812594166364512157703764992040843637676293785442453695875270362324872931845, 23739594375064421056679974979026396887717528129498396083992430965944699110003), (30493866339954454524480332572613433590332703768592049511360700958742048962867, 4941519702987295048235260551311907025515595393387757456730723696871044804713), (3159544095578996766034485247965247767620259611542535193272261898982127068533, 46125301174661399491727557387669816347894215041888964141851899739669385822779), (5557035577325541028982660863011399762015544709140779792219774195777109775979, 10771105784123743922954818973062439664221729055577235693449247249358258104311), (38586067195479813835088454725575267870941075024545394034072817001382438987828, 49721309226478345564249764865106143545451235542711208742394567272315585470240), (5238514231066079463343872487902150785323230681886691615847055753108431102840, 50359460070734964699731355871155003203394648258774210207120216585022186061083), (50343952226907929006219859611008369402656479523727183182074470979041744009037, 24055988330020533465127518130890792273787046072672236992425419628320440779812), (5802449549449568576077377208877034089042675227714719097142911538892451760358, 37740563156329016105645175255232225049901020595495516771647755794163926362737), (30425977125067613585649990969871266924636123154049523155664894092038091489560, 26668037311368447722693191059144737454115524515061489494255632008385027617326), (40538374993794486973003028184262576485686365881828795603988842911771897670598, 29086957306896775832757539167712633146045391916778982164632181618784368469921), (37737997489826814578919977767434182687390754062026485148795432944873332088075, 18948494709854718372731495898748038467889470251968506833127933679644940343783), (38211820961173071562435720760222341411006978338053507179856667165898835017287, 51105155503419248181641487405578791161721047647120367316210222588552785039390), (27216918134885422052205368115452896991408872779447465045866392503823219579457, 36473174891049794422196105961100139310724339115316760968711241757274337059961), (29415977699252153451376870287847356037828891679721752947755714099106142339903, 27268394418136799700198781008060619966588609023753972192645892230627721228703), (10768025600603915025281437680709737791214258686496254519238069890205153978924, 2517321573278452508151807928740021819765746308104188290950247430417246042188), (31697284418947441720317557101882810618054702395384070381292996957229710887041, 34345306077710538168653042205703939972050338525348203149281342977008542135930), (47785661311737527520665207847918258003654882800533237474089298976486122678354, 35289024929911748098600785666637497868888675213257016159122603357108240998474), (2382923594591359033572214534879117597594722627331837413235406449133857931276, 890237093813487428676195585501226811023680786089816115696679272532852672773), (17325956185477233973752410795150579836506578322370713751090177596312788046997, 40358156929708837374656102692389258938231810672805543753520525132531749688396), (12106159879876554556593128801528942679921999685228780568509041618883896223652, 11367303345504196263716044581620764670683519827013773146582838314812513351352), (51090722369417572285021895950435186526233371345848720449996432301479795533011, 40070327258836427127869000490214176707182268822526601920580608392958833163806), (40379221283971721246607842475081005184954503922097915992587609085734472924732, 47562247622275671664233314789819304181812290148153578074552768348680076864675), (44012959375652877869913363805534079957426556261807730679817657114438238667501, 498793394479117673935320085827494004961351178028476890643669526098128282482), (7488945461730474285004689573645157243789129559959916643801185476270896567943, 2741314677382174659471692846909913912661062894357687363859250451984214085612), (29147695108278361516926913589237464610008711915380153186092175614685594755862, 12189313428877920482374343517866277047848462430787146488643656492595054148843), (17322571167464748332139320297822173817617662940346895681154290072779313969994, 44239822534543342426711429517317981998449839157754453373484497188202961019532), (4498776468787507978328341941036679275513119217042172421387450334242021727735, 47892243501064381239491769213216286449543646739400546449206510356979336213884), (13261071672777728306384023707328834568659498803423255585106592124611286878077, 43317155615304465265598961759212869865346178805214840695500801859589047001495), (6279428152276214603654905246512714759191482510607956597723869673696121192764, 36995119035753894909150045043447103042409570749648121423617382864661333985790), (27304275566874946442972422099445942020467924072444650899792270316629026348220, 39956235257342782785537249362056801918093503249916389298612355763676322054588), (52240284069481027893013127070877861793205261393573257906417112587909101735608, 13723070447391995682174232679200468542336470096098957708886820199919336899433), (20062549386223642123770059116497192859993150535253851931545748014916869468985, 20649390064178276673595018477521851496970745440269423844497730203942689896648), (44564832263386436360123939807715191888606367152349423315184901258847286178796, 41801120071365826945195054091232680199601998576733193669058031906854981987313), (5375930039219374784565614144437972076333189111785042755760922921652932374902, 31707554805032125081747934571996542514982319863644300767493173294812808344440), (12621629856907907992291362717954491886578814355508959778615030562145616616999, 49883780551119203976167487523928757449218119378533459708284930888715142996835), (40064047662872521080406144557413152330865132879423284116483587751329566800678, 38148038978200712199451075793591829201471700399986426242596004514911132960837), (48778290201653299418051627567036048811797957690894580058021826823124977283731, 33281596586784735753773681269428898505821183971334120797266848377841706033269), (49872067329364175039761199974710513043099803864203559155486740886338044486697, 35395336102492867296688955520503268970448616687008476001262409926052383071529), (18244224710003547111624201696520654612281708358724434479148792273818913389835, 21600312539422455822184496421202012505760969371884556732520547957363152545019), (17754468880568823331798431106121657021179070075055997396892124029858917971360, 7208991280370893687057391096173365694737910238094634389849358923742596065213), (14225483644866927620075915993378816674803533871184862784639089875290189517501, 21132031982490821283110674881776577145775695568030623540737643422951471942398), (19499185649977680250115831544981287179239505291049451279940868989167897492616, 22328363803616268984019721053837035050694535743416674118251002340802140796681), (12361665559416937552887925828980145683945343748345786176303727015460675755950, 28881133635497233951452283654713911627613106719382103859759238183158945994862), (34729066716145058622421491923894261030918588018758972635106955517855131957624, 35315561547234519289694729816401196390327960433746010438731274237405202940092), (1266341989944894439647011300615432964104234844850382916460571355944293253081, 5330843651339201261374138330694964797256076111478369225375893294465980548413), (52255708801497927685389435395498974627835471177192265101329523580498266345914, 33273937278364327425839758236764023260273916857267805620094090952654569803492), (33580607704967304950948509277085611755724673826916361615029630334374369155256, 36111023057051143008299587222893444419873998251016088002640022784082490136611), (46913178239456299566473144817775756327455213071412305778159657523913613719875, 14357668875359810337395764160712385624874478358271018841147931900517653495993), (28081670707710526253057006079555241494954064976951922269783884479312001390375, 16135814273275834334834700622735166408480284998190443638358118499860970237118), (19216703729601383154213553584593230172539619714521015569892105493756318491384, 885599276696526854153896813260772291559055321941944317024765689497642233783), (41065334421659840042333057313661565592825526952350745297476281449232420272767, 38894304072184519326015377289855030080402092238708223434735171005693673643379), (32481233952804054255474369696586433228894400381678021051950055977705303645877, 49815585335900427612826214428934457336560015480520660340929063230638149812854), (21471492466012302618106478921297357653370082659181333459104945949945351934766, 47362773217071736919170705667879549548626400012167550974071849882885350479729), (16905187166792003319018175200459096412984309982791912714113862907505352248378, 25818780877132770709062721361663492964467853608437245591877630437526608379408), (4866847375140919221714485776579840511850604546852728450567710632907237238062, 35989125484817071074837798442292028712360161827319803300366916272892392364677), (41885789412912246759036967039834425480464661058191266933422348257919909104273, 49038072875741096525055091703194932965771605100829157172688380876468219030788), (26907935779806576975506633815342736468309835934543128784669980176764450533267, 23987730164755246923612859670600816173785525132519190708949578990382511514197), (6831447143942281051496595311332252016332724327867349730697067039830501858139, 51826016799217973652004205612056922220210721495424221091658351148480240847073), (9636542963076669981950598037386805772123467633606545205424509424495842866201, 12253490471102825015734944923046381571541924579941995451486085587503109795767), (48829525853167410315735319463993582791068978678881440215007998517433150421561, 28768719733502936439526092012773670526196038954176759873733994345317833918616), (2022633466287960908924195083699690294518045625577005242642080486704628729977, 30889988327433864569277308269926930598199767184548256216768605029949534211383), (1761159059923454796317052352322378188304869992661104011337765331458470240673, 12558673498273135505307713116382769591472420000077227670556546914483895143445), (10589187028791274117900185895888248324632189617736379781221346121020016637007, 40109191869989069768830553779943185599919345312356796256625722207899348138332), (43060515425979754372633625117506528272433355976220724977448096883997164870241, 31412803598319718827786808913676122226042439614367970988273858797319523587189), (49942788967357881323355123694104526799377017403986036042066525937126325556215, 15731403138443356033479447526857019257361957076191351003404943349543947717123), (3800291203381004832379708043168255045495672311040315672836018655156824206215, 9963007914047486808793938277869672565955811258159965343299482413006042558117), (6923364322230299947489580502995087530173503469296348822752289049428508585354, 2323105435266906988575416310589570020806573861486089348733957234268536122506), (33254743181661676694858281780902381351272106866254319369641160883693267130162, 31856055254671438903862011817067158764023003707195159191591747698854756257785), (14733555028435031551213088935091069122126208844236317148792971057291050345967, 14452203018700162350000157808227745454717884732665647998226621970365621420478), (2596914137988943652339524031581250112111412826413558327702577019072847459448, 6879529072458293233713809524341686480122841677130524878244899435549891863814), (6457499269662033131290802774428094742793121814870744292251721216885069250601, 15519309269940001378098018793074928495310478980047349313513595957439902281669), (10279366883814626015623311521804083436993382756102671695162063917709431953206, 41155567855997032749442229579221455310503577663486430465812748044075822946835), (37312315224383617941133429306319214873462362567866478743171752516485328848886, 39145247650743452971976915565938143194389185105273418465527479915461095049662), (46549647374514858667572903822552357739852650623886450408104505897643835534662, 4287046106856394503437695569466626574657507057739401637444795773215869610725), (27343806747310897259849753138003304539612411021881923812293161553509418527201, 4493794313564223016503875067750876693300440885088005937856068542995095346262), (652786128127922861848137645492803332523553197504043413970000269592514871932, 48810802522665551253306643275030026185187697146888383278844718959783760314799), (18720008310776774373294011903520047435395655812914940264023768432316287974711, 41949388766905763964666127505715602237922876050617696191071978917233797708150), (32959386502717961732520957797556901505924197920405194847609344672872884232808, 28338484942559233515930163715466082209141830013674260215235267608780385663520), (40737494445261586419652469419584082010580084280825399278721601328844833659468, 40108898987200436149555570524769933604380532778049266051129862083940933652164), (39298870046604717667076419797721289153114306806531229634690626412426925647318, 21316610514963074346205694088422818778914873909151805780000299145894474657420), (7422177466884881171945790758212064331338619331983862330345758621541904848085, 19017385594632621700747070561245181498634625190454814828544545886244302005437), (7771660308119401795384712135977626463273345481417518547188372838365305990527, 40040774208045067318886331522427980844598882618911658901686104151069444168029), (37888564244331208120361075213801549417664931586661648904501244368786292221995, 44788663077296610607402333257505143896661961249349165959602983306580475341285), (50219903907139549086028769253379853869116250372039479531087920118632789408401, 3071737740850612327206792485280635601942190142903920664313258242572420217858), (33405403170704933630479946685446487245351272746972398920874614614700511349508, 816595846207631333042825450509253157116381890498837130153201731370187322393), (45288566746930701674896279671129557290772331006058228975462397752016471425018, 48006677259601545069091510530345027331694526990769182028311977412284202297638), (1783739363215166678876715916350757682201936469131964822905549050755409711674, 2191272520847210156197878773506058116207889864282894254379514830070496466120), (47688580684464201771026015902810240083604379770141017265268531644354795864848, 28444120433085978803409917694156111279263282674338731995810025113235065601833), (4249487631457354065053532543879391688139228240247489970339485150870948722713, 20850917171937936407695165470134131960416757360174986917806263196489282779942), (8233264067851627566313825183350093196138836747043252922047419065763244213157, 42668409211345495161800253481893933320174451570002454854213715117964315382243), (7723560569885608316358505087876887121710020709015199755360509835574184995161, 28214673025964173539560997110635426153284359077893609547633286861216483539335), (272030899859916858299225505943699528305276836365854496761075471516709044945, 33324531882569136731993514385126118439317823676231806518404446726547580934364), (45521368996824784187856680878212620992802138142262182735298338675493781756193, 6311706266422240676427426918287044670406762025329741096407398107191977524325), (18054885290963734110934787791327934717135273441343714395055709212733779831337, 28207206975490397154691337289190574978904451953346879548512097755217798227555), (17684688590636159820052505157093761464277594869517924488394315222852489984306, 21668353152311786767564072429177836590813577798197409095598970142277356518313), (44057649140698645968025414489766868809412750468642735996389838122372372884738, 39772757680286158159973103583551717961200771773360725190673009190578535742020), (671092167627621177640288056538706082852984989427398663566938406219656662578, 37467908527370037096050987596919781663833867350827110501343702205070994267419), (10486987844020825503139565195397905622762687471138565627413086807128758762994, 26301722959551980772971027071200562701856960031513935992990669133057597798223), (48375619897004038834704329475532871118920998562920324846865230786812383450389, 40391620793124781475106947091896948399631072189625360842662456156078952920308), (41724153911973286519825410408716616124268856759459935196985303410744804518737, 44235711540510199733197823305322614901659690155804800696508626573317276720506), (32686364769721410554768021743017987676154818057123157731586339586841722669259, 4395500979665069111561350506284650547333188703796818791097088168560178469802), (47398759358459438783625052173928370866728998304164200785387523557260061085759, 565170496107833690227674926719270749721552744519549828280550395156453574070), (40171141386340382207338666942397686385492978952379491685302030099625315942992, 33803599082942692639978183750617238937206473217113899719257770664444575437460), (38931211485697168377733353975775135726691708560364839189002977971417223868848, 15699601086878158565635469141383152087045595540777623733440536257337723167799), (28285718300387490567782432257361408451633791864082769859046587850007337417724, 25771763231744226746034067302570618464058375225325437640885829865814560181102), (44827668977286916093578170209493456588530849447221901202339527882238798125360, 25276060178943264709421445467287881982519271158387552542263486145655837870127), (39202382554943192978627594247256492365615364420448640455239699741107181063174, 11717779461961394466883500616188167546339200920018946992090493265900851183808), (49016169894514363758687132974204046985744006624493086134914382683419942385258, 47997267139441778000553106684317181629488180310935495569833366093554519487594), (40653756614548852682158068454697838241995508214610631110648582333756282337237, 3865842576863461778507600119001492204621902834683569679252376494635758103315), (2828725703770402781309740526791527872345713834026794086406579509092865618794, 32776162900745795209793233176610672853596796573984838901574121483026955841174), (10893711428454652549065265439824795613923453694544509646654732566651106966324, 19785047828419457547649771013390638720504396319242117988747057670384140034572), (37595939471957405194317136494953325116415212802745042596796901602326052293086, 485116815810007717801306930825243530753624698513333851285860840614565628872), (46724542393496419815920113091215936778914247168708515143292121008627230753618, 953265519521236462848943995716152827969286533017219008773161827400059825977), (6861771253654748088374080681532739151284744079804520159074180421664261274165, 31430599891140194167350339210160649561890135905633945386618460628605384261491), (38149457109946884774232436790032722175168462816016397881463402235882912780627, 39739405078470484774812637258990950845336751629836290761302431168342599348600), (13205555696669837985897470182698835642770037179157268147507288301734915851425, 31132788347346513107745949627899956943539902841258090965619518650859845658233), (2859128193181938549160498452759762945123044754642163372973562880417900733615, 48139215270814225455648608660518288728088738164330370069262613010932323341859), (35685141092904807578798276323942544426823914715583259779618578691774102408938, 49136538824750643401689765664663017886653471468181731143088232719048031402930), (26230193140767883997146105608144658044482500888396546529667739169416666862354, 14674417076434243908975346680368853178166526646006656724167970863711606504769), (33803752902183345068354244970735064710170125161545238359922194271888969469325, 4660841738925255725048176545110793430545660900092344354395317934462169605381), (26600237535024013076863728215742497351867675426706174133539813088638586548278, 18761237761580952347861063754357636179885324080986417040586703481789596179800), (50925196521786823246628248312411076579481993733877671530342191006483094609605, 35336707128142829113192802756931531043509357631632360196971121723060388373774), (19772303818452937344607701044901585800892248589797906520064387326999388531799, 45127825778019753738353961632681012067782069903137831874589910180174724920476), (12683216767010200695966060897431991059062254570267228541343874102165941721585, 43960576730626378332589785586053599017129955277672752483250251426324528589979), (5645264488370671728192933030079039003199328527537872619585257159877977176256, 9372903118670367818439262146126170159198374083716445347860218967052597967775), (37061498949605113412241734639599208775603535124572250850160484224479418364049, 7654520446775148027250854872108035622778919704988873002182381054669925634573), (9713500626572654802224066370442409389256977092329666834990224604320178493096, 19170314235870806585234037428261333538568289129949316181424080663180499523161), (36446340732008874544457392468715664463850636607057491658917826218187700687487, 6306633548024826508632452457908794225287184510814017776979588972235642422841), (32109796515922621785246710900366092604218142684188512797849996640251905602217, 32407331812981165871228870670801887224331772542078369573471758457453424792253), (15992145132263351742385727324899580108973002191452454007315134013091490803003, 19800934282994001007986367069357609397232920713140915785500446660831536547175), (3809174032731211293338099811470009988565826972803155964405853686431922062282, 29676262844905998759226996244423828173408102054650470720068422010319069461244), (15894280777368266269264018134137975642631905925524704767801821156620399591917, 42688030053026527633000911512783277513233838252991146415951953506579037933406), (49788690822910963237619340985604165330975316828723906324361748658435865938481, 9160457317619847468199279494729182355814931271749334957035465477468683017549), (20961105066073023833062106702090156152443713695562256662770308844303588216673, 43097043987820854643170782194128204525944134671085372191992451182531402750257), (28687724744387177831442766738649755602928107594401022985392669142474950654665, 22133182809521799085614542511063630896998665720068682457190445244146333901220), (13024317261584557227426620794639410859234550621839920088861201168605735730323, 6350787232314156254479253312735616511940701645844577708341471052910784160981), (49096279514173868679589285560147843475499866533654697837826344096070689345202, 36586109655823474277374633516142679054624697469511406094099349731931982857719), (16109572642794235899349760158444930716859921456709304102542788247524508983230, 27917078860007234283625638873778847515595506035754398349241480042045223929228), (35892827564323741461620453657862736540069353441140975858005543846489133202357, 10078472306834683392839770798623104644572228605242359500607164801052552531457), (18484978253994335400900391204872706929356752108863355797363450176397717295241, 16376561672960785273107532926246325808298275538391382138095048736370155644579), (22319153093923364050592567170301282028901825668308835584635645640062967977586, 43094637986305093220370800433533772538842907423031976535948354136461830310757), (21264659310846003937809382185372595844153519913840346005559899008780267377432, 17899544417444782836006019498342349953205919546101994365716213753260954147867), (20480360925288054246631999255379210531262038885357492171206037664287821189773, 5929056425061841048000631056120058279018678311487023069423389586302854767202), (30604906270940088793292040322458029331197003834904904220304009700983650794578, 26725638327252622552656848820932733174318905904975062242546351947964618337640), (28226173461390820967392783115004374755548666828037949712430744395903084863460, 44496494213319021932409699125517420794005741060448987680453140177876985139771), (47834881548573633565109238679225199808198256939096900792769713673453073268613, 26138367309127462507576424096618831842156015914362411731377872050630096690457), (16955201362337304847889113553652325098025611790543604971436851667500076282662, 32545377464946854132213485433928297418595860481809440221440553775301152240135), (22462704943327682912223776666081413986385195446440640832545252439970415013682, 10031161310582706143645363854562178613445161971357889041561192212863635508732), (33383909240025264863664021575181953806761989002774939137394733594084888857824, 36575337965034156263300354094905517478254783877339325594742240125644981305692), (13755501701228969197731145842077529780333810789476732860302035388829622416518, 42296820875017386362744532513654998019727189977972353577791054289473399565622), (34928013385538043351898336745093534719556260681129244134142503970540636326506, 40840019202675653496611280040525143614540293077842284370612524984883474682019), (34752771093962569919222635342171520170340330638593723545238994087381089500261, 46818709375956021166366899458822038620931558256058644323187206268105097388143), (36802566677011098432081216082554099483307961475735711000664943873037846154959, 11228865490270986103805988346731586582579340256086372012404332744630841835401), (40019120925672383230677563627552939058860578846108880598785608045150348275308, 52005997658592615363941506568104488602533715755691769407794447155314866098375), (9516005105055759340963775740083721794182919934950959900283156977657762024834, 141284052120481692119895002065919057488055095381084320124167840926936869522), (44383548976867049644710404060358290680759423631182407432725187142538866197217, 16570079550683759053210944706241451617300182295430047582262703672791704500968), (21196782632057193149632059028229465255223068724003245576635927171413465502464, 36282777307132948872743922260498231676835301116732766105372996088395910856816), (22533195959015067496144489372584819356860684237558141683715617539239990243033, 10150985522275370954590825658288299106786199137668257962602381048008075733626), (23527446030167385183672301288880458514670867290260020861386751837170703826185, 42162791829135875524009775826654539406873380314920591006221571344884646367290), (25363725502715937501794488413007101573901206975393627613038124076802469757935, 34386153019049692323479786933752830263961515247985952890350696982953684116934), (28836317605438118050738530576696059115077048618020093897063793299583531192434, 21476093676064967192612682845829299579687632947506435807215044660301428458658), (19470043182075152912623059712793161159955944049312895288312656765153082764587, 17205127350167283325057362120918162632747050544457575690535033868332442386210), (39225168571176616096422189736775670197531168133093019852257146162907908834098, 38318823754889551400763216021445709766753868569820104963352054931972120961244), (3142734667903054343964730262664674846019968859042302728040824980202409042195, 42435540029089345139957895843522598805263356868757409076510579446616534628156), (20881640009753068009889978253249438511980029543200475508978512796038891822829, 27968609902807217352706839169055210416306119266743972159646846139577153321146), (6202878911951482584791440140675075028003226366441084032538126321848133088273, 24851320978805441304196414672326898173230285718326922381560663848223170102647), (50070881978905881790688154485363911795896102164461504932917590031909500985704, 43699660924644847032936380042415449426432396553316376125903955630994215373471), (39050911904675050026537096930453299489301613892833411147399076382608918690553, 23065138191144874213305796767304509147666299465390223147896688385250190864754), (43248564896736773616271483377912399618070545196686996456065036741196923875785, 31721938930225437875325316728027640162244123179872753655598024108046977290917), (33816032572798871402707296012525763396838266638976216810437332330642035512151, 1946612142431753251478630793690835505948833864135360052351593237847378887719)]

        for i in range(self.size - 4 - len(ring_pk)):
            ring_pk.append(h_vec[i])
        ring_pk.extend([(0, 0)] * 4)

        # 2. unzip into x/y vectors
        px, py = H.unzip(ring_pk)

        # 3. selector vector
        sel = [1 if i < MAX_RING_SIZE else 0 for i in range(self.size)]

        # 4. Columns
        col_px = Column("Px", px)
        col_py = Column("Py", py)
        col_s = Column("s", sel)

        i_c_start=time.time()

        for col in (col_px, col_py, col_s):
            col.interpolate(self.omega, self.prime)
            col.commit()
        i_c_end=time.time()
        return col_px, col_py, col_s



@dataclass(slots=True)
class WitnessColumnBuilder:
    ring_pk: List[Tuple[int, int]]
    selector_vector: List[int]
    producer_index: int
    secret_t: int
    size: int = SIZE
    omega: int = OMEGA
    prime: int = S_PRIME

    def _bits_vector(self) -> List[int]:
        bv_start=time.time()
        bv = [1 if i == self.producer_index else 0 for i in range(MAX_RING_SIZE)]
        t_bits = bin(self.secret_t)[2:][::-1]
        bv.extend(int(b) for b in t_bits)
        while len(bv) < self.size - 4:
            bv.append(0)
        bv.append(0)# padding bit
        bv_end=time.time()
        return bv

    def _conditional_sum_accumulator(self, b_vector: List[int]) -> tuple[List[int], List[int]]:
        cnd_start=time.time()
        seed_sw= SeedPoint

        acc = [seed_sw]
        for i in range(1, self.size - 3):
            next_pt = acc[i - 1] if b_vector[i - 1] == 0 else TE.add(acc[i - 1], self.ring_pk[i - 1])
            acc.append(next_pt)
        cnd_end=time.time()
        return H.unzip(acc)

    def _inner_product_accumulator(self, b_vector: List[int]) -> List[int]:
        acc = [0]
        for i in range(1, self.size - 3):
            acc.append(acc[i - 1] + b_vector[i - 1] * self.selector_vector[i - 1])
        return acc


    def build(self) -> tuple[Column, Column, Column, Column]:
        b_vec = self._bits_vector()
        acc_x, acc_y = self._conditional_sum_accumulator(b_vec)
        acc_ip = self._inner_product_accumulator(b_vec)

        columns = [
            Column("b", b_vec),
            Column("accx", acc_x),
            Column("accy", acc_y),
            Column("accip", acc_ip),
        ]
        i_c_start=time.time()
        for col in columns:
            col.interpolate(self.omega, self.prime)
            col.commit()
        i_c_end=time.time()
        return tuple(columns)

    def result(self, Blinding_point):
        """
        input: public key, secret vector and Blinding Base
        output: relation as Result Point
        """
        # sw_H = sw.from_twisted_edwards(Blinding_point)
        sw_H= Blinding_point
        PK_k = self.ring_pk[self.producer_index]
        Result_point = TE.add(PK_k, TE.mul(self.secret_t, sw_H))
        return Result_point

    def result_p_seed(self, result):
        """result plus seed"""
        # res=sw.add(result, sw.from_twisted_edwards(SeedPoint))
        res= TE.add(result, SeedPoint)
        return res


